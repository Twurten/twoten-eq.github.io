<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Me</title>
    <link rel="stylesheet" href="./styles.css">
    <link rel="icon" href="./img/2(10.png">
    <script src="./mail.js"></script>
</head>
<body>
    <div class="container" id = "terminaldiv">
        <p class="p" id="firstout">welcome to the terminal <a>type 'help'</a></p>
        <div id="com"></div>
        <div class="input-box" id="inputbox"><a class="input-b" id="tmpid"></a><input type="text" autofocus=true id="input" class="input"></div>
    </div>
    <script>
        document.getElementById("tmpid").innerHTML="<";
        let senderEmail = "";
        let senderMessage = "";
        let discordMessage = "";
        let prev = new Array();
        let terminated = false;

        let input = document.getElementById("input");
        input.addEventListener("keypress", (event) => {
            let code = event.code;

            if(code=="Enter" && !terminated){
                if(input.value!=""){
                let inputt = document.createElement("p");
                inputt.innerHTML=input.value;
                inputt.classList.add("pi");
                let div = document.getElementById("com");
                div.appendChild(inputt);

                switchCommand();
                }
            }
        }, false);


        function switchCommand(){
                let lines = new Array();
                let inp = input.value.split(" ");
                let comm = inp[0];

            switch(comm){
                case "?":
                case "help":
                    lines.push("help / ? - shows the command list");
                    lines.push("inf - about me");
                    lines.push("soc - my contacts");
                    lines.push("to [page] - redirects you to another page");
                    lines.push("msg [message] - send me a message through my discord bot");
                    lines.push("mail [your email] [message] - email me");
                    lines.push("rel - clears the terminal");
                    lines.push("exit - shuts down the terminal");
                    createOutput("COMMAND LIST:", lines);
                break;
                case "soc":
                    createOutput("soc{",lines);
                    let output = document.createElement("div");
                    output.classList.add("soc");
                    let div = document.getElementById("com");
                    div.appendChild(output);
                    
                break;
                case "rel":
                    createOutput("reloading...", lines);
                    location.reload();
                break;
                case "msg":
                    for(let i = 1; i<inp.length; i++)
                        discordMessage+=(inp[i]+" ");
                    //lines.push(discordMessage);
                    createOutput("feature is disabled", lines);
                    discordMessage="";
                break;
                case "to":
                    if(inp[1]!=null){
                        createOutput("redirecting...", lines);
                        input.value="";
                        location.replace("https://twoten-equals.github.io/"+inp[1]);
                    }else{
                        lines.push("the argument cannot be empty")
                        createOutput("error",lines)
                    }
                break;
                case "mail":
                    senderEmail = inp[1];
                    senderMessage = "";
                    for(let i = 2; i<inp.length; i++){
                        senderMessage+=(inp[i]+" ");
                    }
                    
                    if(senderEmail!=null && senderMessage!=""){
                        lines.push("email: "+senderEmail);
                        lines.push("message: "+senderMessage);
                        createOutput("if the data below is right, type \'send\'", lines);
                    }else{
                        lines.push("the arguments cannot be empty")
                        createOutput("error", lines);
                    }
                    senderEmail = "";
                    senderMessage = "";
                break;
                case "inf":
                    createOutput("ABOUT ME",lines);
                break;
                case "send":
                    if(senderEmail!=null && senderMessage!=""){
                        createOutput("feature is disabled?", lines);
                    }else{
                        createOutput("run the \'mail\' command first", lines);
                    }
                break;
                case "exit":
                    createOutput("PROGRAMM TERMINATED", lines);
                    terminated=true;
                break;
                default:
                    createOutput("unknown command", lines);
                break;
            }

            input.value="";
            document.getElementById("terminaldiv").scrollTop = document.getElementById("terminaldiv").scrollHeight;
        }

        function createOutput(content, additional){
            let output = document.createElement("p");
            output.innerHTML=content;
            output.classList.add("p");
            let div = document.getElementById("com");
            div.appendChild(output);
            
            for(let i = 0; i<additional.length; i++){
                let outputPlus = document.createElement("a");
                outputPlus.innerHTML=additional[i];
                output.appendChild(outputPlus);
            }
        }

        function copy(str){
            navigator.clipboard.writeText(str);
                createOutput("copied", new Array());
        }
    </script>
</body>
</html>